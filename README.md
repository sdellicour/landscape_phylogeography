Peaks and valleys of viral landscape phylogeography
===============

This repo gathers the input files and scripts related to our study entitled "**Peaks and valleys of viral landscape phylogeography**" (Dellicour *et al*. *in prep.*). R scripts used to conduct the different analytical steps summarised within the workflow figure just below are all available in `R_scripts_analyses.r`.

Fast evolving pathogens, such as RNA viruses, are characterised by rapid evolution implying that evolutionary and ecological processes occur on the same time scale. Genomic information of these pathogens can then be exploited to analyse the underlying processes that govern their dispersal. In particular, landscape phylogeographic approaches can be used to exploit phylogeographic reconstructions to investigate the impact of environmental factors on the spread of viruses. Here, we improve the existing approach and develop three novel landscape phylogeographic approaches aiming to test the impact of continuous environmental factors on the diffusion velocity of viral lineages. For evaluating their statistical performances, we also implemented two simulation frameworks to test and compare all four resulting approaches. Our analyses allow us to formulate clear guidelines on the use of three complementary landscape phylogeographic approaches associated with sufficient statistical power of detection and the absence of false positives. Our open-source methodological developments have been made available to the community and can be applied to get insights into the drivers of viral spread, with potential benefits for the understanding of their epidemiology and the design of tailored intervention strategies.

<img src="Scripts_&_data/Workflow_figure.png" align="center" alt="" />

**Figure: simulation and analytical workflow implemented to assess the statistical performances of four landscape phylogeographic approaches aiming at testing the impact of environmental factors on the diffusion velocity of viral lineages or on the deviation from an isolation-by-distance pattern.** We here assessed the performance of two post hoc (isolation-by-resistance and lineage diffusion velocity analyses) and two preliminary landscape phylogeography approaches (analyses of continuous phylogeographic reconstructions based on sampling coordinates obtained either after a multidimensional scaling or cartogram transformation). Continuous phylogeographic simulations (step 1), transformations of sampling coordinates (step 2), and landscape phylogeographic analyses were conducted with the R package “[seraphim](https://github.com/sdellicour/seraphim)”, the RNA sequences simulations with the program [πBUSS](https://rega.kuleuven.be/cev/ecv/software/pibuss), and the continuous phylogeographic reconstructions (step 3) with the software package [BEAST X](https://beast.community/) version 1.10.5. (*) Multidimensional scaling (MDS) transformations were conducted based on environmental distances among pair of tip nodes, which were computed using either the least-cost or Circuitscape path model while either considering the environmental raster (here an elevation raster with values rescaled between 0 and 10) or a corresponding “null” raster with accessible raster cell values uniformly equal to “1” (see the study for further detail).
